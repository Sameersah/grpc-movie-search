# 🎬 Movie Search Distributed System

A distributed movie search engine using **gRPC**, **C++**, and **shared memory** to demonstrate efficient inter-process communication and transactionless caching in a multi-server overlay network.

---

## 🚀 Overview

This project implements a **distributed movie search system** across multiple machines using an overlay network: `AB`, `BC`, `BD`, `CE`, and `DE`. It showcases advanced distributed systems concepts like:

- Asynchronous trusted servers  
- Transactionless in-memory + shared memory caching  
- Multi-language clients (C++ & Python)  
- Deduplication logic to avoid redundant results  

---

## ✨ Features

- **Distributed Overlay Network**: Tree-like network of five server processes (A–E)
- **Multi-language Support**: C++ servers with both C++ and Python clients
- **Two-tier Caching**: In-memory + shared memory caching
- **Communication Optimization**: Automatic local IPC using shared memory
- **Efficient Search**: Aggregated search results from distributed data segments
- **Deduplication Logic**: Filters out duplicates from multiple paths

---

## 🧱 System Architecture

            A

            |

            B


        /         \

     C               D

       \            /
        
             E


- **Server A**: Entry point, client-facing, uses shared memory and cache, delegates to B  
- **Server B**: Intermediary, aggregates from C and D, handles deduplication  
- **Servers C & D**: Intermediary processors, forward to E  
- **Server E**: Leaf node, handles raw dataset searching  

---

## 🔧 Prerequisites

- CMake ≥ 3.15  
- gRPC and Protocol Buffers  
- C++17-compatible compiler  
- Python 3.6+ with `grpcio` and `grpcio-tools`  
- POSIX OS (Linux/macOS)  

---

## 🏗️ Building the Project

```bash
# Clone repository
git clone https://github.com/yourusername/movie-search-distributed.git
cd movie-search-distributed

# Create build directory
mkdir -p build && cd build

# Run CMake and build
cmake ..
make

# Generate C++ gRPC code (if not automatically generated by CMake)
mkdir -p ../generated/cpp
protoc --grpc_out=../generated/cpp --cpp_out=../generated/cpp -I.. \
  --plugin=protoc-gen-grpc=`which grpc_cpp_plugin` ../movie.proto

# Generate Python gRPC code
cd ..
python3 -m grpc_tools.protoc -I. --python_out=./generated/python --grpc_python_out=./generated/python movie.proto
```

## Running the System

Start servers (in separate terminals)
```
Server E (leaf)
./build/E_server 127.0.0.1:50005 ./data/E_data.csv

# Servers C and D
./build/C_server 127.0.0.1:50003 127.0.0.1:50005 ./data/C_data.csv
./build/D_server 127.0.0.1:50004 127.0.0.1:50005 ./data/D_data.csv

# Server B
./build/B_server 127.0.0.1:50002 127.0.0.1:50003 127.0.0.1:50004 ./data/B_data.csv

# Server A
./build/A_server 127.0.0.1:50001 127.0.0.1:50002 ./data/A_data.csv 300 100

```

## Run a client

```
C++ Client
./build/client 127.0.0.1:50001

# Python Client
python3 python_client.py 127.0.0.1:50001
```

## Multi-machine Setup

Replace localhost with IPs of respective machines: 

```
# Machine 2
./build/E_server <machine2_ip>:50005 ./data/E_data.csv

# Machine 2
./build/C_server <machine2_ip>:50003 <machine2_ip>:50005 ./data/C_data.csv
./build/D_server <machine3_ip>:50004 <machine2_ip>:50005 ./data/D_data.csv

# Machine 1
./build/B_server <machine1_ip>:50002 <machine2_ip>:50003 <machine2_ip>:50004 ./data/B_data.csv

# Machine 1
./build/A_server <machine1_ip>:50001 <machine1_ip>:50002 ./data/A_data.csv 300 100
```

## Performance Testing

```
# Run performance test
./scripts/test_configurations.sh

# Analyze performance
python3 scripts/analyze_performance.py
```

## Directory Structure

```
MovieSearch/
├── client/           # Client implementations
│   ├── client.cpp    # C++ client
│   └── python_client.py  # Python client
├── server/           # Server implementations
│   ├── A_server.cpp  # Entry point server
│   ├── B_server.cpp  # Intermediary server
│   ├── C_server.cpp  # Leaf server
│   ├── D_server.cpp  # Leaf server
│   ├── E_server.cpp  # Leaf server
│   ├── cache.h       # Cache implementation
│   ├── posix_shared_memory.h  # Shared memory implementation
│   ├── movie_struct.h  # Movie data structure
│   └── response_serializer.h  # Serialization utilities
├── scripts/          # Testing and utility scripts
├── generated/        # Generated gRPC code
├── data/             # Movie data files
├── CMakeLists.txt    # Build configuration
└── proto/movie.proto # Protocol buffer definition
```

